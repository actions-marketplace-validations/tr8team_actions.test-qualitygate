class BasicPolicyEngine {
    #mapper;
    async evaluate(policies, current, base) {
        const start = this.#mapper.inputToIntermediate(current, base);
        const intermediate = await policies.reduce(async (prev, x) => await x.evaluate(await prev), Promise.resolve(start));
        return await this.#mapper.intermediateToOutput(intermediate);
    }
    constructor(mapper) {
        this.#mapper = mapper;
    }
}
export { BasicPolicyEngine };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYmFzaWMtcG9saWN5LWVuZ2luZS5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy9saWIvYmFzaWMtcG9saWN5LWVuZ2luZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFPQSxNQUFNLGlCQUFpQjtJQUNaLE9BQU8sQ0FBZ0I7SUFFaEMsS0FBSyxDQUFDLFFBQVEsQ0FDWixRQUFrQixFQUNsQixPQUFxQixFQUNyQixJQUEwQjtRQUUxQixNQUFNLEtBQUssR0FBRyxJQUFJLENBQUMsT0FBTyxDQUFDLG1CQUFtQixDQUFDLE9BQU8sRUFBRSxJQUFJLENBQUMsQ0FBQztRQUM5RCxNQUFNLFlBQVksR0FBRyxNQUFNLFFBQVEsQ0FBQyxNQUFNLENBQ3hDLEtBQUssRUFBRSxJQUFJLEVBQUUsQ0FBQyxFQUFFLEVBQUUsQ0FBQyxNQUFNLENBQUMsQ0FBQyxRQUFRLENBQUMsTUFBTSxJQUFJLENBQUMsRUFDL0MsT0FBTyxDQUFDLE9BQU8sQ0FBQyxLQUFLLENBQUMsQ0FDdkIsQ0FBQztRQUNGLE9BQU8sTUFBTSxJQUFJLENBQUMsT0FBTyxDQUFDLG9CQUFvQixDQUFDLFlBQVksQ0FBQyxDQUFDO0lBQy9ELENBQUM7SUFFRCxZQUFZLE1BQXFCO1FBQy9CLElBQUksQ0FBQyxPQUFPLEdBQUcsTUFBTSxDQUFDO0lBQ3hCLENBQUM7Q0FDRjtBQUVELE9BQU8sRUFBRSxpQkFBaUIsRUFBRSxDQUFDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgUG9saWN5RW5naW5lIH0gZnJvbSBcIi4vaW50ZXJmYWNlL3BvbGljeS1lbmdpbmVcIjtcbmltcG9ydCB7IEhpc3RvcnlFbnRyeSB9IGZyb20gXCIuL2hpc3RvcnlcIjtcbmltcG9ydCB7IFBvbGljeSB9IGZyb20gXCIuL2ludGVyZmFjZS9wb2xpY3lcIjtcbmltcG9ydCB7IE91dHB1dEVudHJ5IH0gZnJvbSBcIi4vb3V0cHV0XCI7XG5pbXBvcnQgeyBFbGVtZW50TWFwcGVyIH0gZnJvbSBcIi4vaW50ZXJmYWNlL21hcHBlclwiO1xuaW1wb3J0IHsgT3B0aW9uIH0gZnJvbSBcIi4vY29yZS9vcHRpb25cIjtcblxuY2xhc3MgQmFzaWNQb2xpY3lFbmdpbmUgaW1wbGVtZW50cyBQb2xpY3lFbmdpbmUge1xuICByZWFkb25seSAjbWFwcGVyOiBFbGVtZW50TWFwcGVyO1xuXG4gIGFzeW5jIGV2YWx1YXRlKFxuICAgIHBvbGljaWVzOiBQb2xpY3lbXSxcbiAgICBjdXJyZW50OiBIaXN0b3J5RW50cnksXG4gICAgYmFzZTogT3B0aW9uPEhpc3RvcnlFbnRyeT5cbiAgKTogUHJvbWlzZTxPdXRwdXRFbnRyeT4ge1xuICAgIGNvbnN0IHN0YXJ0ID0gdGhpcy4jbWFwcGVyLmlucHV0VG9JbnRlcm1lZGlhdGUoY3VycmVudCwgYmFzZSk7XG4gICAgY29uc3QgaW50ZXJtZWRpYXRlID0gYXdhaXQgcG9saWNpZXMucmVkdWNlKFxuICAgICAgYXN5bmMgKHByZXYsIHgpID0+IGF3YWl0IHguZXZhbHVhdGUoYXdhaXQgcHJldiksXG4gICAgICBQcm9taXNlLnJlc29sdmUoc3RhcnQpXG4gICAgKTtcbiAgICByZXR1cm4gYXdhaXQgdGhpcy4jbWFwcGVyLmludGVybWVkaWF0ZVRvT3V0cHV0KGludGVybWVkaWF0ZSk7XG4gIH1cblxuICBjb25zdHJ1Y3RvcihtYXBwZXI6IEVsZW1lbnRNYXBwZXIpIHtcbiAgICB0aGlzLiNtYXBwZXIgPSBtYXBwZXI7XG4gIH1cbn1cblxuZXhwb3J0IHsgQmFzaWNQb2xpY3lFbmdpbmUgfTtcbiJdfQ==