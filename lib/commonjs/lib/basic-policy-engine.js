class BasicPolicyEngine {
    #mapper;
    async evaluate(policies, current, base) {
        const start = this.#mapper.inputToIntermediate(current, base);
        const intermediate = await policies.reduce(async (prev, x) => await x.evaluate(await prev), Promise.resolve(start));
        return this.#mapper.intermediateToOutput(intermediate);
    }
    constructor(mapper) {
        this.#mapper = mapper;
    }
}
export { BasicPolicyEngine };
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiYmFzaWMtcG9saWN5LWVuZ2luZS5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy9saWIvYmFzaWMtcG9saWN5LWVuZ2luZS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFPQSxNQUFNLGlCQUFpQjtJQUNaLE9BQU8sQ0FBZ0I7SUFFaEMsS0FBSyxDQUFDLFFBQVEsQ0FDWixRQUFrQixFQUNsQixPQUFxQixFQUNyQixJQUEwQjtRQUUxQixNQUFNLEtBQUssR0FBRyxJQUFJLENBQUMsT0FBTyxDQUFDLG1CQUFtQixDQUFDLE9BQU8sRUFBRSxJQUFJLENBQUMsQ0FBQztRQUM5RCxNQUFNLFlBQVksR0FBRyxNQUFNLFFBQVEsQ0FBQyxNQUFNLENBQ3hDLEtBQUssRUFBRSxJQUFJLEVBQUUsQ0FBQyxFQUFFLEVBQUUsQ0FBQyxNQUFNLENBQUMsQ0FBQyxRQUFRLENBQUMsTUFBTSxJQUFJLENBQUMsRUFDL0MsT0FBTyxDQUFDLE9BQU8sQ0FBQyxLQUFLLENBQUMsQ0FDdkIsQ0FBQztRQUNGLE9BQU8sSUFBSSxDQUFDLE9BQU8sQ0FBQyxvQkFBb0IsQ0FBQyxZQUFZLENBQUMsQ0FBQztJQUN6RCxDQUFDO0lBRUQsWUFBWSxNQUFxQjtRQUMvQixJQUFJLENBQUMsT0FBTyxHQUFHLE1BQU0sQ0FBQztJQUN4QixDQUFDO0NBQ0Y7QUFFRCxPQUFPLEVBQUUsaUJBQWlCLEVBQUUsQ0FBQyIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFBvbGljeUVuZ2luZSB9IGZyb20gXCIuL2ludGVyZmFjZS9wb2xpY3ktZW5naW5lXCI7XG5pbXBvcnQgeyBIaXN0b3J5RW50cnkgfSBmcm9tIFwiLi9oaXN0b3J5XCI7XG5pbXBvcnQgeyBQb2xpY3kgfSBmcm9tIFwiLi9pbnRlcmZhY2UvcG9saWN5XCI7XG5pbXBvcnQgeyBPdXRwdXRFbnRyeSB9IGZyb20gXCIuL291dHB1dFwiO1xuaW1wb3J0IHsgRWxlbWVudE1hcHBlciB9IGZyb20gXCIuL2ludGVyZmFjZS9tYXBwZXJcIjtcbmltcG9ydCB7IE9wdGlvbiB9IGZyb20gXCIuL2NvcmUvb3B0aW9uXCI7XG5cbmNsYXNzIEJhc2ljUG9saWN5RW5naW5lIGltcGxlbWVudHMgUG9saWN5RW5naW5lIHtcbiAgcmVhZG9ubHkgI21hcHBlcjogRWxlbWVudE1hcHBlcjtcblxuICBhc3luYyBldmFsdWF0ZShcbiAgICBwb2xpY2llczogUG9saWN5W10sXG4gICAgY3VycmVudDogSGlzdG9yeUVudHJ5LFxuICAgIGJhc2U6IE9wdGlvbjxIaXN0b3J5RW50cnk+XG4gICk6IFByb21pc2U8T3V0cHV0RW50cnk+IHtcbiAgICBjb25zdCBzdGFydCA9IHRoaXMuI21hcHBlci5pbnB1dFRvSW50ZXJtZWRpYXRlKGN1cnJlbnQsIGJhc2UpO1xuICAgIGNvbnN0IGludGVybWVkaWF0ZSA9IGF3YWl0IHBvbGljaWVzLnJlZHVjZShcbiAgICAgIGFzeW5jIChwcmV2LCB4KSA9PiBhd2FpdCB4LmV2YWx1YXRlKGF3YWl0IHByZXYpLFxuICAgICAgUHJvbWlzZS5yZXNvbHZlKHN0YXJ0KVxuICAgICk7XG4gICAgcmV0dXJuIHRoaXMuI21hcHBlci5pbnRlcm1lZGlhdGVUb091dHB1dChpbnRlcm1lZGlhdGUpO1xuICB9XG5cbiAgY29uc3RydWN0b3IobWFwcGVyOiBFbGVtZW50TWFwcGVyKSB7XG4gICAgdGhpcy4jbWFwcGVyID0gbWFwcGVyO1xuICB9XG59XG5cbmV4cG9ydCB7IEJhc2ljUG9saWN5RW5naW5lIH07XG4iXX0=